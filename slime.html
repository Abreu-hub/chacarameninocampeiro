<!DOCTYPE html>
<html lang="pt-BR">
<head>


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DEKRSE4D4M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DEKRSE4D4M');
</script>


  <meta charset="UTF-8">
  <title>Super Mario World - Fases e Biomas</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #87CEEB;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    canvas {
      background: #5c94fc;
      display: block;
      margin-bottom: 20px;
    }

    .buttons-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }

    button {
      padding: 10px;
      margin: 10px;
      background-color: #2d72d9;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #1c4b8a;
    }

    .controls-container {
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }

    .control-btn {
      font-size: 24px;
      padding: 10px 20px;
      margin: 5px;
      background-color: #eee;
      border: 2px solid #888;
      border-radius: 10px;
      cursor: pointer;
    }

    .control-btn:active {
      background-color: #ccc;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="400"></canvas>

  <div class="buttons-container">
    <button id="startButton">Iniciar Jogo</button>
    <button id="exitButton" style="display:none;">
      <a href="index.html" style="text-decoration: none; color: white;">Finalizar Jogo</a>
    </button>
  </div>

  <div class="controls-container">
    <button class="control-btn" id="leftBtn">⬅️</button>
    <button class="control-btn" id="upBtn">⬆️</button>
    <button class="control-btn" id="rightBtn">➡️</button>
  </div>

  <script>
    let score = 0;
    let lives = 3;
    let currentBiome = 'floresta';
    let level = 1;
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const slimeImg = new Image();
    slimeImg.src = 'slime.png';

    const mario = {
      x: 100,
      y: 300,
      width: 40,
      height: 60,
      speed: 5,
      jumpForce: -12,
      velocityY: 0,
      grounded: false,
      jumpCount: 0,
      velocityX: 0
    };

    const gravity = 0.6;
    const keys = { left: false, right: false, up: false };

    const platformSets = {
      floresta: [
        { x: 300, y: 250, width: 100, height: 10 },
        { x: 450, y: 220, width: 100, height: 10 },
        { x: 600, y: 250, width: 100, height: 10 }
      ],
      deserto: [
        { x: 100, y: 200, width: 150, height: 10 },
        { x: 400, y: 180, width: 120, height: 10 },
        { x: 700, y: 220, width: 120, height: 10 }
      ]
    };

    const enemySets = {
      floresta: [{ x: 500, y: 230, width: 40, height: 40, speedX: 2, speedY: 1 }],
      deserto: [{ x: 350, y: 170, width: 40, height: 40, speedX: 2, speedY: 1 }]
    };

    const starSets = {
      floresta: [{ x: 550, y: 190, width: 20, height: 20 }],
      deserto: [{ x: 650, y: 170, width: 20, height: 20 }]
    };

    const heartSets = {
      floresta: [],
      deserto: []
    };

    function changeBiome() {
      level++;
      if (currentBiome === 'floresta') {
        currentBiome = 'deserto';
        platformSets[currentBiome].push({ x: 450, y: 180, width: 100, height: 10 });
        enemySets[currentBiome].push({ x: 600, y: 150, width: 40, height: 40, speedX: 2, speedY: 1 });
      } else {
        currentBiome = 'floresta';
        platformSets[currentBiome].push({ x: 600, y: 250, width: 100, height: 10 });
        enemySets[currentBiome].push({ x: 500, y: 230, width: 40, height: 40, speedX: 2, speedY: 1 });
      }

      if (score >= 50) {
        heartSets[currentBiome].push({ x: Math.random() * 700 + 50, y: Math.random() * 300 + 50, width: 20, height: 20 });
      }

      if (score >= 100) {
        heartSets[currentBiome].push({ x: Math.random() * 700 + 50, y: Math.random() * 300 + 50, width: 20, height: 20 });
      }

      enemySets[currentBiome].push({ x: Math.random() * 700 + 50, y: Math.random() * 300 + 50, width: 40, height: 40, speedX: 2, speedY: 1 });
      starSets[currentBiome].push({ x: Math.random() * 700 + 50, y: Math.random() * 300 + 50, width: 20, height: 20 });
    }

    function rectsCollide(a, b) {
      return a.x < b.x + b.width && a.x + a.width > b.x && a.y < b.y + b.height && a.y + a.height > b.y;
    }

    function update() {
      if (lives <= 0) return;

      mario.velocityY += gravity;
      mario.y += mario.velocityY;

      if (keys.right) mario.x += mario.speed;
      if (keys.left && mario.x > 0) mario.x -= mario.speed;

      const groundY = canvas.height - 50;
      if (mario.y + mario.height > groundY) {
        mario.y = groundY - mario.height;
        mario.velocityY = 0;
        mario.grounded = true;
        mario.jumpCount = 0;
      } else {
        mario.grounded = false;
      }

      const platforms = platformSets[currentBiome];
      for (let p of platforms) {
        if (rectsCollide(mario, p)) {
          if (mario.velocityY > 0) {
            mario.velocityY = 0;
            mario.y = p.y - mario.height;
            mario.grounded = true;
            mario.jumpCount = 0;
          } else if (mario.velocityY < 0) {
            mario.velocityY = 0;
            mario.y = p.y + p.height;
          }
        }
      }

      const enemies = enemySets[currentBiome];
      for (let enemy of enemies) {
        enemy.x += enemy.speedX;
        enemy.y += enemy.speedY;
        if (enemy.y <= 100 || enemy.y >= canvas.height - 50) {
          enemy.speedY = -enemy.speedY;
        }

        if (enemy.x > canvas.width - enemy.width || enemy.x < 0) {
          enemy.speedX = -enemy.speedX;
        }

        if (rectsCollide(mario, enemy)) {
          lives--;
          mario.x = 100;
          mario.y = 300;
          mario.velocityY = 0;
        }
      }

      const stars = starSets[currentBiome];
      for (let star of stars) {
        if (rectsCollide(mario, star)) {
          starSets[currentBiome].splice(stars.indexOf(star), 1);
          score += 5;
        }
      }

      const hearts = heartSets[currentBiome];
      for (let heart of hearts) {
        if (rectsCollide(mario, heart)) {
          heartSets[currentBiome].splice(hearts.indexOf(heart), 1);
          lives++;
        }
      }

      if (mario.x > canvas.width - mario.width) {
        mario.x = 100;
        changeBiome();
      }

      draw();
      requestAnimationFrame(update);
    }

    function drawLives() {
      for (let i = 0; i < lives; i++) {
        ctx.fillStyle = "red";
        ctx.beginPath();
        ctx.arc(30 + i * 30, 30, 10, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = currentBiome === 'floresta' ? '#228B22' : '#D2B48C';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Desenha o slime.png
      ctx.drawImage(slimeImg, mario.x, mario.y, mario.width, mario.height);

      const platforms = platformSets[currentBiome];
      ctx.fillStyle = '#8B4513';
      for (let p of platforms) {
        ctx.fillRect(p.x, p.y, p.width, p.height);
      }

      const enemies = enemySets[currentBiome];
      ctx.fillStyle = 'green';
      for (let enemy of enemies) {
        ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
      }

      const stars = starSets[currentBiome];
      ctx.fillStyle = 'yellow';
      for (let star of stars) {
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.width / 2, 0, Math.PI * 2);
        ctx.fill();
      }

      const hearts = heartSets[currentBiome];
      ctx.fillStyle = 'red';
      for (let heart of hearts) {
        ctx.beginPath();
        ctx.arc(heart.x, heart.y, heart.width / 2, 0, Math.PI * 2);
        ctx.fill();
      }

      ctx.fillStyle = 'black';
      ctx.font = '20px Arial';
      ctx.fillText('Pontuação: ' + score, canvas.width - 150, 30);

      drawLives();

      if (lives <= 0) {
        ctx.fillStyle = 'black';
        ctx.font = '40px Arial';
        ctx.fillText('GAME OVER', canvas.width / 2 - 120, canvas.height / 2);
      }
    }

    document.getElementById('startButton').addEventListener('click', function() {
      document.getElementById('startButton').style.display = 'none';
      document.getElementById('exitButton').style.display = 'block';
      update();
    });

    window.addEventListener('keydown', function(event) {
      if (event.key === "ArrowLeft" || event.key === "a") keys.left = true;
      if (event.key === "ArrowRight" || event.key === "d") keys.right = true;
      if (event.key === "ArrowUp" || event.key === "w") {
        if (mario.grounded || mario.jumpCount < 2) {
          mario.velocityY = mario.jumpForce;
          mario.jumpCount++;
        }
      }
    });

    window.addEventListener('keyup', function(event) {
      if (event.key === "ArrowLeft" || event.key === "a") keys.left = false;
      if (event.key === "ArrowRight" || event.key === "d") keys.right = false;
    });

    // Botões visuais de controle
    document.getElementById('leftBtn').addEventListener('touchstart', () => keys.left = true);
    document.getElementById('leftBtn').addEventListener('touchend', () => keys.left = false);

    document.getElementById('rightBtn').addEventListener('touchstart', () => keys.right = true);
    document.getElementById('rightBtn').addEventListener('touchend', () => keys.right = false);

    document.getElementById('upBtn').addEventListener('touchstart', () => {
      if (mario.grounded || mario.jumpCount < 2) {
        mario.velocityY = mario.jumpForce;
        mario.jumpCount++;
      }
    });

    document.getElementById('leftBtn').addEventListener('mousedown', () => keys.left = true);
    document.getElementById('leftBtn').addEventListener('mouseup', () => keys.left = false);

    document.getElementById('rightBtn').addEventListener('mousedown', () => keys.right = true);
    document.getElementById('rightBtn').addEventListener('mouseup', () => keys.right = false);

    document.getElementById('upBtn').addEventListener('mousedown', () => {
      if (mario.grounded || mario.jumpCount < 2) {
        mario.velocityY = mario.jumpForce;
        mario.jumpCount++;
      }
    });
  </script>
</body>
</html>
